<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tvb.datatypes.equations_data &mdash; The Virtual Brain 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="The Virtual Brain 1.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">The Virtual Brain 1.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for tvb.datatypes.equations_data</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c">#  TheVirtualBrain-Scientific Package. This package holds all simulators, and </span>
<span class="c"># analysers necessary to run brain-simulations. You can use it stand alone or</span>
<span class="c"># in conjunction with TheVirtualBrain-Framework Package. See content of the</span>
<span class="c"># documentation-folder for more details. See also http://www.thevirtualbrain.org</span>
<span class="c">#</span>
<span class="c"># (c) 2012-2013, Baycrest Centre for Geriatric Care (&quot;Baycrest&quot;)</span>
<span class="c">#</span>
<span class="c"># This program is free software; you can redistribute it and/or modify it under </span>
<span class="c"># the terms of the GNU General Public License version 2 as published by the Free</span>
<span class="c"># Software Foundation. This program is distributed in the hope that it will be</span>
<span class="c"># useful, but WITHOUT ANY WARRANTY; without even the implied warranty of </span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public</span>
<span class="c"># License for more details. You should have received a copy of the GNU General </span>
<span class="c"># Public License along with this program; if not, you can download it here</span>
<span class="c"># http://www.gnu.org/licenses/old-licenses/gpl-2.0</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c">#   CITATION:</span>
<span class="c"># When using The Virtual Brain for scientific publications, please cite it as follows:</span>
<span class="c">#</span>
<span class="c">#   Paula Sanz Leon, Stuart A. Knock, M. Marmaduke Woodman, Lia Domide,</span>
<span class="c">#   Jochen Mersmann, Anthony R. McIntosh, Viktor Jirsa (2013)</span>
<span class="c">#       The Virtual Brain: a simulator of primate brain network dynamics.</span>
<span class="c">#   Frontiers in Neuroinformatics (7:10. doi: 10.3389/fninf.2013.00010)</span>
<span class="c">#</span>
<span class="c">#</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">The Data component of the Equation datatypes. These are intended to be </span>
<span class="sd">evaluated via numexp and are used in defining things like stimuli and local </span>
<span class="sd">connectivity.</span>

<span class="sd">We only make use of single variable equations, the variable is written as var ?use x?</span>
<span class="sd">in the equation...</span>

<span class="sd">.. moduleauthor:: Stuart A. Knock &lt;Stuart@tvb.invalid&gt;</span>
<span class="sd">.. moduleauthor:: Lia Domide &lt;lia.domide@codemart.ro&gt;</span>
<span class="sd">.. moduleauthor:: Paula Sanz Leon &lt;paula@tvb.invalid&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c">#TODO: Need to consider a split into zero-mean and not zero-mean for FiniteSupportEquations...</span>
<span class="c">#TODO: Consider adding an attribute of default range, sensible for default parameters...</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">tvb.basic.traits.types_basic</span> <span class="kn">as</span> <span class="nn">basic</span>
<span class="kn">import</span> <span class="nn">tvb.basic.traits.core</span> <span class="kn">as</span> <span class="nn">core</span>
<span class="kn">from</span> <span class="nn">tvb.basic.logger.builder</span> <span class="kn">import</span> <span class="n">get_logger</span>


<span class="n">LOG</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>



<div class="viewcode-block" id="EquationData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.EquationData">[docs]</a><span class="k">class</span> <span class="nc">EquationData</span><span class="p">(</span><span class="n">basic</span><span class="o">.</span><span class="n">MapAsJson</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Within the UI we&#39;ll access via the specific Equation subclasses implemented below.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_base_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Equation&#39;</span><span class="p">,</span> <span class="s">&#39;FiniteSupportEquation&#39;</span><span class="p">,</span> <span class="s">&quot;DiscreteEquation&quot;</span><span class="p">,</span>
                     <span class="s">&quot;TemporalApplicableEquation&quot;</span><span class="p">,</span> <span class="s">&quot;SpatialApplicableEquation&quot;</span><span class="p">,</span> <span class="s">&quot;HRFKernelEquation&quot;</span><span class="p">,</span>
                     <span class="c">#TODO: There should be a refactor of Coupling which may make these unnecessary</span>
                     <span class="s">&#39;Coupling&#39;</span><span class="p">,</span> <span class="s">&#39;CouplingData&#39;</span><span class="p">,</span> <span class="s">&#39;CouplingScientific&#39;</span><span class="p">,</span> <span class="s">&#39;CouplingFramework&#39;</span><span class="p">,</span>
                     <span class="s">&#39;LinearCoupling&#39;</span><span class="p">,</span> <span class="s">&#39;LinearCouplingData&#39;</span><span class="p">,</span> <span class="s">&#39;LinearCouplingScientific&#39;</span><span class="p">,</span> <span class="s">&#39;LinearCouplingFramework&#39;</span><span class="p">,</span>
                     <span class="s">&#39;SigmoidalCoupling&#39;</span><span class="p">,</span> <span class="s">&#39;SigmoidalCouplingData&#39;</span><span class="p">,</span> <span class="s">&#39;SigmoidalCouplingScientific&#39;</span><span class="p">,</span>
                     <span class="s">&#39;SigmoidalCouplingFramework&#39;</span><span class="p">]</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Equation as a string&quot;</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;A latex representation of the equation, with the extra</span>
<span class="s">            escaping needed for interpretation via sphinx.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Parameters in a dictionary.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;Should be a list of the parameters and their meaning, Traits</span>
<span class="s">            should be able to take defaults and sensible ranges from any </span>
<span class="s">            traited information that was provided.&quot;&quot;&quot;</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="DiscreteEquationData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.DiscreteEquationData">[docs]</a><span class="k">class</span> <span class="nc">DiscreteEquationData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A special case for &#39;discrete&#39; spaces, such as the regions, where each point</span>
<span class="sd">    in the space is effectively just assigned a value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Discrete Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;var&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;The equation defines a function of :math:`x`&quot;&quot;&quot;</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="LinearData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.LinearData">[docs]</a><span class="k">class</span> <span class="nc">LinearData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A linear equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Linear Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;a * var + b&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`result = a * x + b`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Linear Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                 <span class="s">&quot;b&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="GaussianData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.GaussianData">[docs]</a><span class="k">class</span> <span class="nc">GaussianData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Gaussian equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaussian Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;amp * exp(-((var-midpoint)**2 / (2.0 * sigma**2)))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`amp </span><span class="se">\\</span><span class="s">exp</span><span class="se">\\</span><span class="s">left(-</span><span class="se">\\</span><span class="s">left(</span><span class="se">\\</span><span class="s">left(x-midpoint</span><span class="se">\\</span><span class="s">right)^2 /</span>
<span class="s">        </span><span class="se">\\</span><span class="s">left(2.0 </span><span class="se">\\</span><span class="s">sigma^2</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right)`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Gaussian Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;amp&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;sigma&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;midpoint&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="DoubleGaussianData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.DoubleGaussianData">[docs]</a><span class="k">class</span> <span class="nc">DoubleGaussianData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Mexican-hat function approximated by the difference of Gaussians functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_ui_name</span> <span class="o">=</span> <span class="s">&quot;Mexican-hat&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Double Gaussian Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;(amp_1 * exp(-((var-midpoint_1)**2 / (2.0 * sigma_1**2)))) - (amp_2 * exp(-((var-midpoint_2)**2 / (2.0 * sigma_2**2))))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`amp_1 </span><span class="se">\\</span><span class="s">exp</span><span class="se">\\</span><span class="s">left(-</span><span class="se">\\</span><span class="s">left((x-midpoint_1)^2 / </span><span class="se">\\</span><span class="s">left(2.0</span>
<span class="s">        </span><span class="se">\\</span><span class="s">sigma_1^2</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right) - </span>
<span class="s">        amp_2 </span><span class="se">\\</span><span class="s">exp</span><span class="se">\\</span><span class="s">left(-</span><span class="se">\\</span><span class="s">left((x-midpoint_2)^2 / </span><span class="se">\\</span><span class="s">left(2.0  </span>
<span class="s">        </span><span class="se">\\</span><span class="s">sigma_2^2</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right)</span><span class="se">\\</span><span class="s">right)`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Double Gaussian Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;amp_1&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">&quot;sigma_1&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span> <span class="s">&quot;midpoint_1&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                 <span class="s">&quot;amp_2&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;sigma_2&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s">&quot;midpoint_2&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="SigmoidData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.SigmoidData">[docs]</a><span class="k">class</span> <span class="nc">SigmoidData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Sigmoid equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sigmoid Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;amp / (1.0 + exp(-1.8137993642342178 * (radius-var)/sigma))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`amp / (1.0 + </span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">pi/</span><span class="se">\\</span><span class="s">sqrt(3.0)</span>
<span class="s">            (radius-x)/</span><span class="se">\\</span><span class="s">sigma))`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sigmoid Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;amp&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;radius&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s">&quot;sigma&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span> <span class="c">#&quot;pi&quot;: numpy.pi,</span>


</div>
<div class="viewcode-block" id="GeneralizedSigmoidData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.GeneralizedSigmoidData">[docs]</a><span class="k">class</span> <span class="nc">GeneralizedSigmoidData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A General Sigmoid equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Generalized Sigmoid Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;low + (high - low) / (1.0 + exp(-1.8137993642342178 * (var-midpoint)/sigma))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`low + (high - low) / (1.0 + </span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">pi/</span><span class="se">\\</span><span class="s">sqrt(3.0)</span>
<span class="s">            (x-midpoint)/</span><span class="se">\\</span><span class="s">sigma))`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sigmoid Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s">&quot;high&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;midpoint&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;sigma&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span> <span class="c">#,</span>
    <span class="c">#&quot;pi&quot;: numpy.pi})</span>


</div>
<div class="viewcode-block" id="SinusoidData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.SinusoidData">[docs]</a><span class="k">class</span> <span class="nc">SinusoidData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Sinusoid equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sinusoid Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;amp * sin(6.283185307179586 * frequency * var)&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`amp </span><span class="se">\\</span><span class="s">sin(2.0 </span><span class="se">\\</span><span class="s">pi frequency x)` &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Sinusoid Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;amp&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;frequency&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">})</span> <span class="c">#kHz #&quot;pi&quot;: numpy.pi,</span>


</div>
<div class="viewcode-block" id="CosineData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.CosineData">[docs]</a><span class="k">class</span> <span class="nc">CosineData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Cosine equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Cosine Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;amp * cos(6.283185307179586 * frequency * var)&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`amp </span><span class="se">\\</span><span class="s">cos(2.0 </span><span class="se">\\</span><span class="s">pi frequency x)` &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Cosine Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;amp&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;frequency&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">})</span> <span class="c">#kHz #&quot;pi&quot;: numpy.pi,</span>


</div>
<div class="viewcode-block" id="AlphaData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.AlphaData">[docs]</a><span class="k">class</span> <span class="nc">AlphaData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An Alpha function belonging to the Exponential function family.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Alpha Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;where((var-onset) &gt; 0, (alpha * beta) / (beta - alpha) * (exp(-alpha * (var-onset)) - exp(-beta * (var-onset))), 0.0 * var)&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`(</span><span class="se">\\</span><span class="s">alpha * </span><span class="se">\\</span><span class="s">beta) / (</span><span class="se">\\</span><span class="s">beta - </span><span class="se">\\</span><span class="s">alpha) *</span>
<span class="s">            (</span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">alpha * (x-onset)) - </span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">beta * (x-onset)))` for :math:`(x-onset) &gt; 0`&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Alpha Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;onset&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span> <span class="s">&quot;beta&quot;</span><span class="p">:</span> <span class="mf">42.0</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="PulseTrainData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.PulseTrainData">[docs]</a><span class="k">class</span> <span class="nc">PulseTrainData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A pulse train , offseted with respect to the time axis.</span>
<span class="sd">    </span>
<span class="sd">    **Parameters**:</span>
<span class="sd">    </span>
<span class="sd">    * :math:`\\tau` :  pulse width or pulse duration</span>
<span class="sd">    * :math:`T`     :  pulse repetition period</span>
<span class="sd">    * :math:`f`     :  pulse repetition frequency (1/T)</span>
<span class="sd">    * duty cycle    :  :math:``\\frac{\\tau}{T}`` (for a square wave: 0.5)</span>
<span class="sd">    * onset time    :</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Pulse Train&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;where((var % T) &lt; tau, amp, 0)&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">tau}{T}</span>
<span class="s">        +</span><span class="se">\\</span><span class="s">sum_{n=1}^{</span><span class="se">\\</span><span class="s">infty}</span><span class="se">\\</span><span class="s">frac{2}{n</span><span class="se">\\</span><span class="s">pi}</span>
<span class="s">        </span><span class="se">\\</span><span class="s">sin</span><span class="se">\\</span><span class="s">left(</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">pi</span><span class="se">\\</span><span class="s">,n</span><span class="se">\\</span><span class="s">tau}{T}</span><span class="se">\\</span><span class="s">right)</span>
<span class="s">        </span><span class="se">\\</span><span class="s">cos</span><span class="se">\\</span><span class="s">left(</span><span class="se">\\</span><span class="s">frac{2</span><span class="se">\\</span><span class="s">pi</span><span class="se">\\</span><span class="s">,n}{T} var</span><span class="se">\\</span><span class="s">right)`. </span>
<span class="s">        The starting time is halfway through the first pulse. </span>
<span class="s">        The phase can be offset t with t - tau/2&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c"># onset is in milliseconds</span>
    <span class="c"># T and tau are in milliseconds as well</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;T&quot;</span><span class="p">:</span> <span class="mf">42.0</span><span class="p">,</span> <span class="s">&quot;tau&quot;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span> <span class="s">&quot;amp&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;onset&quot;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">},</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Pulse Train Parameters&quot;</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="GammaData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.GammaData">[docs]</a><span class="k">class</span> <span class="nc">GammaData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Gamma function for the bold monitor. It belongs to the family of Exponential functions.</span>
<span class="sd">    </span>
<span class="sd">    **Parameters**:</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    * :math:`\\tau`      : Exponential time constant of the gamma function [seconds].</span>
<span class="sd">    * :math:`n`          : The phase delay of the gamma function.</span>
<span class="sd">    * :math: `factorial` : (n-1)!. numexpr does not support factorial yet. </span>
<span class="sd">    * :math: `a`         : Amplitude factor after normalization.</span>


<span class="sd">    **Reference**:</span>
<span class="sd">     </span>
<span class="sd">    .. [B_1996] Geoffrey M. Boynton, Stephen A. Engel, Gary H. Glover and David </span>
<span class="sd">        J. Heeger (1996). Linear Systems Analysis of Functional Magnetic Resonance </span>
<span class="sd">        Imaging in Human V1. J Neurosci 16: 4207-4221</span>

<span class="sd">    .. note:: might be filtered from the equations used in Stimulus and Local Connectivity.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ui_name</span> <span class="o">=</span> <span class="s">&quot;HRF kernel: Gamma kernel&quot;</span>

    <span class="c"># TODO: Introduce a time delay in the equation (shifts the hrf onset)</span>
    <span class="c"># &quot;&quot;&quot;:math:`h(t) = \frac{(\frac{t-\delta}{\tau})^{(n-1)} e^{-(\frac{t-\delta}{\tau})}}{\tau(n-1)!}&quot;&quot;&quot;</span>
    <span class="c"># delta = 2.05 seconds -- Additional delay in seconds from the onset of the</span>
    <span class="c"># time-series to the beginning of the gamma hrf.</span>
    <span class="c"># delay cannot be negative or greater than the hrf duration. </span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Gamma Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;((var / tau) ** (n - 1) * exp(-(var / tau)) )/ (tau * factorial)&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`h(var) = </span><span class="se">\\</span><span class="s">frac{(</span><span class="se">\\</span><span class="s">frac{var}{</span><span class="se">\\</span><span class="s">tau})^{(n-1)}</span><span class="se">\\</span><span class="s">exp{-(</span><span class="se">\\</span><span class="s">frac{var}{</span><span class="se">\\</span><span class="s">tau})}}{</span><span class="se">\\</span><span class="s">tau(n-1)!}`.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Gamma Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;tau&quot;</span><span class="p">:</span> <span class="mf">1.08</span><span class="p">,</span> <span class="s">&quot;n&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s">&quot;factorial&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="DoubleExponentialData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.DoubleExponentialData">[docs]</a><span class="k">class</span> <span class="nc">DoubleExponentialData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A difference of two exponential functions to define a kernel for the bold monitor.</span>

<span class="sd">    **Parameters** :</span>

<span class="sd">    * :math:`\\tau_1`: Time constant of the second exponential function [s]</span>
<span class="sd">    * :math:`\\tau_2`: Time constant of the first exponential function [s].</span>
<span class="sd">    * :math:`f_1`  : Frequency of the first sine function [Hz].</span>
<span class="sd">    * :math:`f_2`  : Frequency of the second sine function [Hz].</span>
<span class="sd">    * :math:`amp_1`: Amplitude of the first exponential function.</span>
<span class="sd">    * :math:`amp_2`: Amplitude of the second exponential function.</span>
<span class="sd">    * :math:`a`    : Amplitude factor after normalization.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    **Reference**:</span>
<span class="sd">    </span>
<span class="sd">    .. [P_2000] Alex Polonsky, Randolph Blake, Jochen Braun and David J. Heeger</span>
<span class="sd">        (2000). Neuronal activity in human primary visual cortex correlates with</span>
<span class="sd">        perception during binocular rivalry. Nature Neuroscience 3: 1153-1159</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ui_name</span> <span class="o">=</span> <span class="s">&quot;HRF kernel: Difference of Exponentials&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Double Exponential Equation&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;((amp_1 * exp(-var/tau_1) * sin(2.*pi*f_1*var)) - (amp_2 * exp(-var/ tau_2) * sin(2.*pi*f_2*var)))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`h(var) = amp_1</span><span class="se">\\</span><span class="s">exp(</span><span class="se">\\</span><span class="s">frac{-var}{</span><span class="se">\t</span><span class="s">au_1})</span>
<span class="s">        </span><span class="se">\\</span><span class="s">sin(2</span><span class="se">\\</span><span class="s">cdot</span><span class="se">\\</span><span class="s">pi f_1 </span><span class="se">\\</span><span class="s">cdot var) - amp_2</span><span class="se">\\</span><span class="s">cdot </span><span class="se">\\</span><span class="s">exp(-</span><span class="se">\\</span><span class="s">frac{var}</span>
<span class="s">        {</span><span class="se">\\</span><span class="s">tau_2})*</span><span class="se">\\</span><span class="s">sin(2</span><span class="se">\\</span><span class="s">pi f_2 var)`.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Double Exponential Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;tau_1&quot;</span><span class="p">:</span> <span class="mf">7.22</span><span class="p">,</span> <span class="s">&quot;f_1&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s">&quot;amp_1&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                 <span class="s">&quot;tau_2&quot;</span><span class="p">:</span> <span class="mf">7.4</span><span class="p">,</span> <span class="s">&quot;f_2&quot;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span> <span class="s">&quot;amp_2&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                 <span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&quot;pi&quot;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="FirstOrderVolterraData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.FirstOrderVolterraData">[docs]</a><span class="k">class</span> <span class="nc">FirstOrderVolterraData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integral form of the first Volterra kernel of the three used in the </span>
<span class="sd">    Ballon Windekessel model for computing the Bold signal. </span>
<span class="sd">    This function describes a damped Oscillator.</span>

<span class="sd">    **Parameters** :    </span>

<span class="sd">    * :math:`\\tau_s`: Dimensionless? exponential decay parameter.</span>
<span class="sd">    * :math:`\\tau_f`: Dimensionless? oscillatory parameter. </span>
<span class="sd">    * :math:`k_1`    : First Volterra kernel coefficient. </span>
<span class="sd">    * :math:`V_0` : Resting blood volume fraction. </span>


<span class="sd">    **References** :</span>
<span class="sd">     </span>
<span class="sd">    .. [F_2000] Friston, K., Mechelli, A., Turner, R., and Price, C., *Nonlinear </span>
<span class="sd">        Responses in fMRI: The Balloon Model, Volterra Kernels, and Other </span>
<span class="sd">        Hemodynamics*, NeuroImage, 12, 466 - 477, 2000.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ui_name</span> <span class="o">=</span> <span class="s">&quot;HRF kernel: Volterra Kernel&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;First Order Volterra Kernel&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;1/3. * exp(-0.5*(var / tau_s)) * (sin(sqrt(1./tau_f - 1./(4.*tau_s**2)) * var)) / (sqrt(1./tau_f - 1./(4.*tau_s**2)))&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`G(t - t^{</span><span class="se">\\</span><span class="s">prime}) =</span>
<span class="s">             e^{</span><span class="se">\\</span><span class="s">frac{1}{2} </span><span class="se">\\</span><span class="s">left(</span><span class="se">\\</span><span class="s">frac{t - t^{</span><span class="se">\\</span><span class="s">prime}}{</span><span class="se">\\</span><span class="s">tau_s} </span><span class="se">\\</span><span class="s">right)}</span>
<span class="s">             </span><span class="se">\\</span><span class="s">frac{\sin</span><span class="se">\\</span><span class="s">left((t - t^{</span><span class="se">\\</span><span class="s">prime})</span>
<span class="s">             </span><span class="se">\\</span><span class="s">sqrt{</span><span class="se">\\</span><span class="s">frac{1}{</span><span class="se">\\</span><span class="s">tau_f} - </span><span class="se">\\</span><span class="s">frac{1}{4 </span><span class="se">\\</span><span class="s">tau_s^2}}</span><span class="se">\\</span><span class="s">right)}</span>
<span class="s">             {</span><span class="se">\\</span><span class="s">sqrt{</span><span class="se">\\</span><span class="s">frac{1}{</span><span class="se">\\</span><span class="s">tau_f} - </span><span class="se">\\</span><span class="s">frac{1}{4 </span><span class="se">\\</span><span class="s">tau_s^2}}}</span>
<span class="s">             </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">;  for </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; t </span><span class="se">\\</span><span class="s">geq t^{</span><span class="se">\\</span><span class="s">prime}</span>
<span class="s">             = 0 </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">;  for </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">; </span><span class="se">\\</span><span class="s">;  t &lt; t^{</span><span class="se">\\</span><span class="s">prime}`.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Mixture of Gammas Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;tau_s&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s">&quot;tau_f&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&quot;k_1&quot;</span><span class="p">:</span> <span class="mf">5.6</span><span class="p">,</span> <span class="s">&quot;V_0&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">})</span>


</div>
<div class="viewcode-block" id="MixtureOfGammasData"><a class="viewcode-back" href="../../../tvb.datatypes.html#tvb.datatypes.equations_data.MixtureOfGammasData">[docs]</a><span class="k">class</span> <span class="nc">MixtureOfGammasData</span><span class="p">(</span><span class="n">EquationData</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A mixture of two gamma distributions to create a kernel similar to the one used in SPM.</span>

<span class="sd">    &gt;&gt; import scipy.stats as sp_stats</span>
<span class="sd">    &gt;&gt; import numpy</span>
<span class="sd">    &gt;&gt; t = numpy.linspace(1,20,100)</span>
<span class="sd">    &gt;&gt; a1, a2 = 6., 10.</span>
<span class="sd">    &gt;&gt; lambda = 1.</span>
<span class="sd">    &gt;&gt; c      = 0.5</span>
<span class="sd">    &gt;&gt; hrf    = sp_stats.gamma.pdf(t, a1, lambda) - c * sp_stats.gamma.pdf(t, a2, lambda)</span>

<span class="sd">    gamma.pdf(x, a, theta) = (lambda*x)**(a-1) * exp(-lambda*x) / gamma(a)</span>
<span class="sd">    a                 : shape parameter</span>
<span class="sd">    theta: 1 / lambda : scale parameter</span>


<span class="sd">    **References**:    </span>

<span class="sd">    .. [G_1999] Glover, G. *Deconvolution of Impulse Response in Event-Related BOLD fMRI*.</span>
<span class="sd">                NeuroImage 9, 416-429, 1999.</span>


<span class="sd">    **Parameters**:</span>
<span class="sd">    </span>

<span class="sd">    * :math:`a_{1}`       : shape parameter first gamma pdf.</span>
<span class="sd">    * :math:`a_{2}`       : shape parameter second gamma pdf.</span>
<span class="sd">    * :math:`\\lambda`    : scale parameter first gamma pdf.</span>


<span class="sd">    Default values are based on [G_1999]_:</span>
<span class="sd">    * :math:`a_{1} - 1 = n_{1} =  5.0` </span>
<span class="sd">    * :math:`a_{2} - 1 = n_{2} = 12.0`</span>
<span class="sd">    * :math:`c \\equiv a_{2}   = 0.4` </span>

<span class="sd">    Alternative values :math:`a_{2}=10` and :math:`c=0.5`</span>

<span class="sd">    NOTE: gamma_a_1 and gamma_a_2 are placeholders, the true values are</span>
<span class="sd">    computed before evaluating the expression, because numexpr does not</span>
<span class="sd">    support certain functions.</span>

<span class="sd">    NOTE: [G_1999]_ used a different analytical function that can be approximated</span>
<span class="sd">    by this difference of gamma pdfs</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ui_name</span> <span class="o">=</span> <span class="s">&quot;HRF kernel: Mixture of Gammas&quot;</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">String</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Mixture of Gammas&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s">&quot;(l * var)**(a_1-1) * exp(-l*var) / gamma_a_1 - c * (l*var)**(a_2-1) * exp(-l*var) / gamma_a_2&quot;</span><span class="p">,</span>
        <span class="n">locked</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;:math:`</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">lambda </span><span class="se">\\</span><span class="s">,t^{a_{1} - 1} </span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">, </span><span class="se">\\</span><span class="s">exp^{-</span><span class="se">\\</span><span class="s">lambda </span><span class="se">\\</span><span class="s">,t}}{</span><span class="se">\\</span><span class="s">Gamma(a_{1})} </span>
<span class="s">        - 0.5 </span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">lambda </span><span class="se">\\</span><span class="s">,t^{a_{2} - 1} </span><span class="se">\\</span><span class="s">,</span><span class="se">\\</span><span class="s">, </span><span class="se">\\</span><span class="s">exp^{-</span><span class="se">\\</span><span class="s">lambda </span><span class="se">\\</span><span class="s">,t}}{</span><span class="se">\\</span><span class="s">Gamma(a_{2})}`.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="n">basic</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">&quot;Double Exponential Parameters&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;a_1&quot;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s">&quot;a_2&quot;</span><span class="p">:</span> <span class="mf">13.0</span><span class="p">,</span> <span class="s">&quot;l&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s">&quot;gamma_a_1&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;gamma_a_2&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>


<span class="c"># TODO: half cosine model</span>
<span class="c"># TODO: mixture of gammma functions (Glover 1999 and Lindquist implementation 2009)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/evil_tvb_logo_transparent.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">The Virtual Brain 1.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>